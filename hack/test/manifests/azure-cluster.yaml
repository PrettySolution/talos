## Cluster configs

apiVersion: cluster.x-k8s.io/v1alpha2
kind: Cluster
metadata:
  name: talos-e2e-{{TAG}}-azure
  namespace: default
spec:
  clusterNetwork:
    pods:
      cidrBlocks:
      - 192.168.0.0/16
  infrastructureRef:
    apiVersion: infrastructure.cluster.x-k8s.io/v1alpha2
    kind: AzureCluster
    name: talos-e2e-{{TAG}}-azure
    namespace: default
---
apiVersion: infrastructure.cluster.x-k8s.io/v1alpha2
kind: AzureCluster
metadata:
  name: talos-e2e-{{TAG}}-azure
  namespace: default
spec:
  location: centralus
  networkSpec:
    vnet:
      name: talos-e2e-vnet
    # subnets:
    #   - name: talos-e2e
    #     id: "/subscriptions/64739c64-c063-4c9d-bf2c-d1191ed8befa/resourceGroups/talos/providers/Microsoft.Network/virtualNetworks/talos-e2e-vnet/subnets/talos-e2e-subnet"
    #     vnetID: "/subscriptions/64739c64-c063-4c9d-bf2c-d1191ed8befa/resourceGroups/talos/providers/Microsoft.Network/virtualNetworks/talos-e2e-vnet"
    #     securityGroup:
    #       name: talos-e2e-sg
    #       id: "/subscriptions/64739c64-c063-4c9d-bf2c-d1191ed8befa/resourceGroups/talos/providers/Microsoft.Network/networkSecurityGroups/talos-e2e-sg"
  resourceGroup: talos
---

## Controlplane 0 configs

apiVersion: bootstrap.cluster.x-k8s.io/v1alpha2
kind: TalosConfig
metadata:
  name: talos-e2e-{{TAG}}-azure-controlplane-0
  namespace: default
spec:
  machineType: init
---
apiVersion: cluster.x-k8s.io/v1alpha2
kind: Machine
metadata:
  name: talos-e2e-{{TAG}}-azure-controlplane-0
  labels:
    cluster.x-k8s.io/control-plane: "true"
    cluster.x-k8s.io/cluster-name: "talos-e2e-{{TAG}}-azure"
spec:
  version: v1.16.2
  bootstrap:
    configRef:
      apiVersion: bootstrap.cluster.x-k8s.io/v1alpha2
      kind: TalosConfig
      name: talos-e2e-{{TAG}}-azure-controlplane-0
  infrastructureRef:
    apiVersion: infrastructure.cluster.x-k8s.io/v1alpha2
    kind: AzureMachine
    name: talos-e2e-{{TAG}}-azure-controlplane-0
---
apiVersion: infrastructure.cluster.x-k8s.io/v1alpha2
kind: AzureMachine
metadata:
  name: talos-e2e-{{TAG}}-azure-controlplane-0
spec:
  image:
    id: "/subscriptions/64739c64-c063-4c9d-bf2c-d1191ed8befa/resourceGroups/talos/providers/Microsoft.Compute/images/azure-e2e-{{TAG}}"
  location: centralus
  osDisk:
    diskSizeGB: 10
    managedDisk:
      storageAccountType: Premium_LRS
    osType: Linux
  sshPublicKey: ""
  vmSize: Standard_B2s
  allocatePublicIP: true
---

